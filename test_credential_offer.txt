# Test Credential Offer URLs

## For Quick Testing (Copy and Use)

### 1. Sample Credential Offer (Pre-Authorized Code Flow)

**URL Format:**
```
openid-credential-offer://?credential_offer=<JSON_ENCODED>
```

**Decoded Example:**
```json
{
  "credential_issuer": "https://issuer.eudiw.dev",
  "credentials": [
    {
      "format": "mso_mdoc",
      "doctype": "org.iso.18013.5.1.mDL"
    }
  ],
  "grants": {
    "urn:ietf:params:oauth:grant-type:pre-authorized_code": {
      "pre-authorized_code": "test-pre-auth-code-12345"
    }
  }
}
```

### 2. How to Test in Your App

**Method 1: Using the Official Test Issuer**
1. Visit: https://issuer.eudiw.dev
2. Select "Mobile Driving License" or "PID"
3. Click "Generate Credential Offer"
4. Scan the generated QR code with your app

**Method 2: Using Test URLs Directly**
You can create test QR codes from these URLs:

**Test PID (Person ID) Offer:**
```
https://issuer.eudiw.dev/credential_offer?credential_configuration_id=eu.europa.ec.eudi.pid.1
```

**Test mDL (Mobile Driving License) Offer:**
```
https://issuer.eudiw.dev/credential_offer?credential_configuration_id=org.iso.18013.5.1.mDL
```

### 3. Generate QR Code for Testing

**Online QR Generator:**
- https://www.qr-code-generator.com
- Paste the credential offer URL
- Download the QR code
- Display on another device or print
- Scan with your wallet app

**Or use command line:**
```bash
# Install qrencode
brew install qrencode

# Generate QR code
echo "https://issuer.eudiw.dev/credential_offer?credential_configuration_id=eu.europa.ec.eudi.pid.1" | qrencode -t UTF8

# Or save as image
echo "https://issuer.eudiw.dev/credential_offer?credential_configuration_id=eu.europa.ec.eudi.pid.1" | qrencode -o test_credential_offer.png
```

### 4. Test with Flutter Dev Tools

**Option A: Simulate QR Scan**
In your Flutter code, you can manually trigger the credential offer:

```dart
// In your test or debug code
final testOfferUrl = 'https://issuer.eudiw.dev/credential_offer?credential_configuration_id=eu.europa.ec.eudi.pid.1';
await procivisService.acceptCredentialOffer(testOfferUrl, holderDidId: yourDidId);
```

**Option B: Use Flutter DevTools**
```bash
# Open DevTools
flutter pub global activate devtools
flutter pub global run devtools

# In DevTools console, trigger:
window.dispatchEvent(CustomEvent('qr_scanned', detail: {'data': 'credential_offer_url'}));
```

### 5. Expected Credential Data After Issuance

**What you'll receive:**
```json
{
  "id": "cred-abc-123",
  "name": "Person Identification Data",
  "type": "VerifiableCredential",
  "format": "SD-JWT-VC",
  "issuerName": "EUDI Test Issuer",
  "issuerDid": "did:web:issuer.eudiw.dev",
  "holderDid": "did:key:z6Mk...",
  "issuedDate": "2026-01-27T08:00:00Z",
  "expiryDate": "2027-01-27T08:00:00Z",
  "claims": {
    "family_name": "Test",
    "given_name": "User",
    "birth_date": "1990-01-01",
    "age_over_18": true,
    "nationality": "EU"
  },
  "state": "valid"
}
```

### 6. Verify Credential Storage

**Check files on device:**
```bash
# iOS Simulator
ls -la ~/Library/Developer/CoreSimulator/Devices/*/data/Containers/Data/Application/*/Documents/eudi_wallet/

# View stored credentials
cat ~/Library/Developer/CoreSimulator/Devices/*/data/Containers/Data/Application/*/Documents/eudi_wallet/credentials.json | jq
```

### 7. Alternative Test Issuers

**Other EUDI-compatible test issuers:**

1. **iGrant.io Test Issuer**
   - URL: https://issuer.igrant.io
   - Supports: OpenID4VCI
   - Free test credentials

2. **Sphereon Test Issuer**
   - Various demo credentials available
   - Multiple formats supported

3. **Local Test Issuer**
   - Clone: https://github.com/eu-digital-identity-wallet/eudi-srv-pid-issuer
   - Run locally for testing

### 8. Mock Credential for UI Testing

If you want to test UI without real issuance, add mock credentials:

**Add to `lib/services/credential_service.dart`:**
```dart
Future<void> addMockCredential() async {
  final mockCredential = CredentialDto(
    id: 'mock-${DateTime.now().millisecondsSinceEpoch}',
    name: 'Test Mobile Driving License',
    type: 'mDL',
    format: 'ISO_MDL',
    issuerName: 'Test DMV',
    issuerDid: 'did:web:test.issuer.com',
    holderDid: 'did:key:z6MkTest...',
    issuedDate: DateTime.now().toIso8601String(),
    expiryDate: DateTime.now().add(Duration(days: 365)).toIso8601String(),
    claims: {
      'family_name': 'Doe',
      'given_name': 'John',
      'birth_date': '1990-01-01',
      'document_number': 'DL123456789',
      'driving_privileges': ['A', 'B'],
    },
    proofType: 'JwtProof2020',
    state: 'valid',
    backgroundColor: '#4F46E5',
    textColor: '#FFFFFF',
  );

  credentials.add(mockCredential);
  await _saveToCache();
  notifyListeners();
}
```

**Call from UI:**
```dart
// Add button in Settings or Debug menu
ElevatedButton(
  onPressed: () async {
    await credentialService.addMockCredential();
    ScaffoldMessenger.of(context).showSnackBar(
      SnackBar(content: Text('Mock credential added!')),
    );
  },
  child: Text('Add Mock Credential'),
)
```

---

**Quick Start:**
1. Visit https://issuer.eudiw.dev
2. Generate credential offer QR code
3. Open your wallet app
4. Tap Scan button
5. Scan the QR code
6. Credential appears in your wallet!
